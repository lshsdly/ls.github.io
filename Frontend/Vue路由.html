<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue 路由 | Better than never</title>
    <meta name="description" content="梁的个人网站">
    <link rel="icon" href="/logo.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.80698cd3.css" as="style"><link rel="preload" href="/assets/js/app.aa07e3f0.js" as="script"><link rel="preload" href="/assets/js/2.3c3a8b86.js" as="script"><link rel="preload" href="/assets/js/20.7e1fbe74.js" as="script"><link rel="prefetch" href="/assets/js/10.16485189.js"><link rel="prefetch" href="/assets/js/11.087b2c37.js"><link rel="prefetch" href="/assets/js/12.1232ddd6.js"><link rel="prefetch" href="/assets/js/13.d08737f4.js"><link rel="prefetch" href="/assets/js/14.5400c51f.js"><link rel="prefetch" href="/assets/js/15.6e20fcc4.js"><link rel="prefetch" href="/assets/js/16.8f188508.js"><link rel="prefetch" href="/assets/js/17.31b200b9.js"><link rel="prefetch" href="/assets/js/18.09631d42.js"><link rel="prefetch" href="/assets/js/19.ea1c561c.js"><link rel="prefetch" href="/assets/js/21.6a57e774.js"><link rel="prefetch" href="/assets/js/22.0b5e3d00.js"><link rel="prefetch" href="/assets/js/23.c0b1a40b.js"><link rel="prefetch" href="/assets/js/24.6aaf1c96.js"><link rel="prefetch" href="/assets/js/25.52f988b5.js"><link rel="prefetch" href="/assets/js/26.ca333bb8.js"><link rel="prefetch" href="/assets/js/27.c6dae7fd.js"><link rel="prefetch" href="/assets/js/28.5e816cc0.js"><link rel="prefetch" href="/assets/js/3.1a056928.js"><link rel="prefetch" href="/assets/js/4.1ae91333.js"><link rel="prefetch" href="/assets/js/5.9279dd66.js"><link rel="prefetch" href="/assets/js/6.5e5f6408.js"><link rel="prefetch" href="/assets/js/7.a81f715f.js"><link rel="prefetch" href="/assets/js/8.d07cfd7b.js"><link rel="prefetch" href="/assets/js/9.b0483dea.js">
    <link rel="stylesheet" href="/assets/css/0.styles.80698cd3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Better than never</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Frontend/" class="nav-link router-link-active">前端相关</a></div><div class="nav-item"><a href="/resume.html" class="nav-link">个人简历</a></div><div class="nav-item"><a href="/Tools.html" class="nav-link">工具资源（待）</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Frontend/" class="nav-link router-link-active">前端相关</a></div><div class="nav-item"><a href="/resume.html" class="nav-link">个人简历</a></div><div class="nav-item"><a href="/Tools.html" class="nav-link">工具资源（待）</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Vue 路由</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#单页应用" class="sidebar-link">单页应用</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#使用" class="sidebar-link">使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#引入" class="sidebar-link">引入</a></li><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#注册" class="sidebar-link">注册</a></li><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#渲染" class="sidebar-link">渲染</a></li></ul></li><li><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#导航" class="sidebar-link">导航</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#router-link-链接导航" class="sidebar-link">router-link 链接导航</a></li><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#js-代码导航" class="sidebar-link">js 代码导航</a></li></ul></li><li><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#配置路由参数" class="sidebar-link">配置路由参数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#设置" class="sidebar-link">设置</a></li><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#获取" class="sidebar-link">获取</a></li><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#子路由-嵌套路由" class="sidebar-link">子路由 / 嵌套路由</a></li><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#查询参数" class="sidebar-link">查询参数</a></li></ul></li><li><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#多路由视图-命名路由视图" class="sidebar-link">多路由视图 / 命名路由视图</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#重定向" class="sidebar-link">重定向</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#动画过渡" class="sidebar-link">动画过渡</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#传递-hash-fragment" class="sidebar-link">传递 Hash Fragment</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#保护路由" class="sidebar-link">保护路由</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#检测能否进入特定路由" class="sidebar-link">检测能否进入特定路由</a></li><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#检测能否离开特定路由" class="sidebar-link">检测能否离开特定路由</a></li></ul></li><li><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#懒加载" class="sidebar-link">懒加载</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#结合-vue-异步组件-和-webpack-代码分割功能实现路由懒加载" class="sidebar-link">结合 Vue 异步组件 和 Webpack 代码分割功能实现路由懒加载</a></li><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#把组件按组分块" class="sidebar-link">把组件按组分块</a></li><li class="sidebar-sub-header"><a href="/Frontend/Vue%E8%B7%AF%E7%94%B1.html#老版语法" class="sidebar-link">老版语法</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-路由"><a href="#vue-路由" aria-hidden="true" class="header-anchor">#</a> Vue 路由</h1> <blockquote><p>Max: Vue.js 2.0
2019/08/20</p></blockquote> <h2 id="单页应用"><a href="#单页应用" aria-hidden="true" class="header-anchor">#</a> 单页应用</h2> <p>从技术层面看，只有一个页面，也就是在 index.html 中存放整个应用，然后使用这个唯一的页面，模拟出可以跳转页面的交互的感觉。</p> <p>URL 还是会变化的，而且我们会监听这些变化，然后对 index 进行重载，造成浏览不同页面的感觉。</p> <p>我们不需要在应用里加载从服务器获取到的各个页面，然后用 Vue 对页面某部分进行处理，整个应用都是用 Vue 来控制的。</p> <p>路由类似于在组件间切换。</p> <h2 id="使用"><a href="#使用" aria-hidden="true" class="header-anchor">#</a> 使用</h2> <h3 id="引入"><a href="#引入" aria-hidden="true" class="header-anchor">#</a> 引入</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> VueRouter <span class="token keyword">from</span> <span class="token string">'vue-router'</span><span class="token punctuation">;</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueRouter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>路由可以设置在不同文件里，然后引入到 main.js，但是仍需要注册到 main.js 的根实例上，尤其对于创建单页应用而言。</p> <blockquote><p>由于路由在实际开发中会用到很多个，所以虽然可以设置在 main.js 中，但仍推荐采用设置到不同文件然后引入的做法。</p></blockquote> <h3 id="注册"><a href="#注册" aria-hidden="true" class="header-anchor">#</a> 注册</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// routes.js 设置</span>
<span class="token keyword">import</span> Home <span class="token keyword">from</span> <span class="token string">'./Home.vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> User <span class="token keyword">from</span> <span class="token string">'./User.vue'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>	<span class="token comment">// 设置常量用来保存路由</span>
	<span class="token comment">// 保存路由意味着它有一个数组，数组内有多个对象，每个对象代表一个路由，需要对之进行注册。</span>
	<span class="token punctuation">{</span>
		path<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>	<span class="token comment">// 每个路由需要一个 path 属性，其内容会在之后添加到域名 Url 后面，每次访问显示在 url 地址中；path 为空就是首先进行加载的根路由，即每次访问域名 / 时，就会加载 Home 组件。</span>
		component<span class="token punctuation">:</span> Home	<span class="token comment">// 每次访问该路由需要加载的组件</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
		path<span class="token punctuation">:</span> <span class="token string">'/user'</span><span class="token punctuation">,</span>
		component<span class="token punctuation">:</span> User
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// main.js 导入及注册</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> routes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./routes'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	routes<span class="token punctuation">:</span> routes	<span class="token comment">// ES6 可简写为 routes，会自动遍历该对象所有键值对</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	el<span class="token punctuation">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
	router<span class="token punctuation">,</span>	<span class="token comment">// 同上</span>
	<span class="token function-variable function">render</span><span class="token punctuation">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="渲染"><a href="#渲染" aria-hidden="true" class="header-anchor">#</a> 渲染</h3> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- App.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- vue-router 内置组件，告知应用在这里加载需要的组件 --&gt;</span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- 此时是未设置路径的，浏览器地址栏会在根路径后显示 '/#/'，这是 vue-router 的默认工作模式 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>地址栏后的 '#' 是什么？</li></ul> <p>不加 # 的其他地址，用户每次点击链接，都会给服务器发送请求——这是服务器或浏览器的机制。
当我们想在单页应用内部处理路由时，就不希望将路由交给服务器处理了。</p> <p>但在第一次访问页面时，需要访问服务器以获取整个单页应用本身：如访问 /user 不加 # 时，应该获取单页应用本身即 index.html 页，然后由单页应用接管 url 的余下部分。</p> <ul><li><code>#</code>：
<ul><li>之前的 URL 会被发送的服务器，然后服务器返回 index.html</li> <li>之后的会传给正在运行的 JS 应用，交由应用处理，然后应用就能获取地址栏的路径</li> <li>这样的机制运行良好，只不过需要对服务器进行特殊配置，令服务器在任何情况包括 404 都返回 index.html</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// main.js 导入及注册</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	routes<span class="token punctuation">:</span> routes<span class="token punctuation">,</span>
	mode<span class="token punctuation">:</span> <span class="token string">'history'</span>	<span class="token comment">// 告知 Vue 采用上述的路由配置，令之不显示 #（默认显示 # 的为 hash）</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="导航"><a href="#导航" aria-hidden="true" class="header-anchor">#</a> 导航</h2> <h3 id="router-link-链接导航"><a href="#router-link-链接导航" aria-hidden="true" class="header-anchor">#</a> router-link 链接导航</h3> <p>不使用 a 标签的 href 属性，因为它会将请求发送到服务器，尽管服务器可以处理这件事，但它还有其他弊端：</p> <ol><li>限制设置已访问的链接的方式</li> <li>一定会向服务器发送一个请求，不发送请求可能更好</li></ol> <ul><li>优化方式：<code>&lt;router-link&gt;</code></li></ul> <p>特点：</p> <ul><li>默认最终会被渲染成 a 标签</li> <li>允许你用有别于 a 标签的方法配置它</li></ul> <p>原理：</p> <ul><li>在链接上添加一个<strong>隐式的鼠标点击事件监听器</strong>，点击这个链接不会执行默认操作，不会发送请求到服务器，而是通过监听点击，加载正确路由。</li></ul> <p>属性：</p> <ul><li>to: 设置跳转链接
<ul><li>相对路径：
<ul><li>user，添加到<strong>当前 URL</strong> 上，组成实际访问的链接</li> <li>/user，添加到<strong>域名后</strong>，组成实际访问的链接</li></ul></li> <li>可以动态绑定</li></ul></li> <li>tag: 设置要渲染成的标签</li> <li>active-class: Vue 在当前链接添加对应名称的类
<ul><li>默认 router-link-active</li></ul></li> <li>exact: 覆盖默认的机制，要求完全匹配
<ul><li>默认机制见下</li></ul></li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>li<span class="token punctuation">&quot;</span></span> <span class="token attr-name">active-class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>active<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>li<span class="token punctuation">&quot;</span></span> <span class="token attr-name">active-class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>active<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>User<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 直接这样设置会导致第一个链接始终存在 active 类，因为 Vue 会首先查看链接指向的地方，然后查看当前 url，默认情况下，只要 URL 以 / 链接开头，就会被选中（在嵌套链接情况下这样是可用的）。解决方式为： --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>li<span class="token punctuation">&quot;</span></span> <span class="token attr-name">active-class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>active<span class="token punctuation">&quot;</span></span> <span class="token attr-name">exact</span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="js-代码导航"><a href="#js-代码导航" aria-hidden="true" class="header-anchor">#</a> js 代码导航</h3> <ul><li>push: 将这个路由添加到历史记录里，以便浏览器的前进后退功能正常使用，因为我们保存了原来的路由</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 传入要跳转的路由</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 传入对象</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="配置路由参数"><a href="#配置路由参数" aria-hidden="true" class="header-anchor">#</a> 配置路由参数</h2> <h3 id="设置"><a href="#设置" aria-hidden="true" class="header-anchor">#</a> 设置</h3> <ul><li>添加 <code>:id</code>，设置名字以便之后访问。
<ul><li>使用：<code>user/sth</code>，sth 作为 id 传入</li> <li>可以做更复杂的传入，如 /:id/details</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// routes.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/user/:id'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> User<span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="获取"><a href="#获取" aria-hidden="true" class="header-anchor">#</a> 获取</h3> <ul><li><code>this.$route.params.id</code> <ul><li>访问传入的数据 id</li></ul></li></ul> <p>组件是加载路由后才创建，访问路由实例中的参数就没有问题。</p> <blockquote><p>可能存在的其他问题：
当同页面中有两个及以上链接到相同组件、传递不同参数的路由时，虽然切换过程中 path 变化，但是加载是原来的组件，Vue 不会重新创建组件，会导致通过 $route.params 获取的参数无变化。</p> <p>解决方案：
设置 $route 的监听器 watch 或使用计算属性。</p></blockquote> <h3 id="子路由-嵌套路由"><a href="#子路由-嵌套路由" aria-hidden="true" class="header-anchor">#</a> 子路由 / 嵌套路由</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/user'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> User<span class="token punctuation">,</span> children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
		<span class="token comment">// 存放要嵌套在这个根路径下的子路由</span>
		<span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> UserStart<span class="token punctuation">}</span>	<span class="token comment">// 子路由的 Path 如果加 /，会加到根域名后面，如果不加 /，会加到父路由路径后</span>
	<span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>设置完成后需要在子路由节点上添加对应的 router-view。</p> <ul><li>router-view 中的 to 属性形式：</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 1. 普通形式 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 2. 绑定形式，可用字符串拼接 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>/name/'+$route.params.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 3. 灵活形式 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{path: 'userEdit'}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 传入一个对象，在这个对象里设置一些属性决定跳转路径。 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{name: 'userEdit', params: {key: value}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 这是更常用的方式，直接传入对应路由的 name；Vue 会自动智能补全路径；可传参。 --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>第三种形式前置工作——给路由命名：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// routes.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">':id/edit'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> UserEdit<span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'userEdit'</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="查询参数"><a href="#查询参数" aria-hidden="true" class="header-anchor">#</a> 查询参数</h3> <p>查询参数位于 URL 后面的参数，总是位于末尾，以 <code>?</code> 开头，以 <code>&amp;</code> 分隔，如：<em><code>?search=haha&amp;id=7</code></em>。</p> <ul><li>是能在路由里传递的最多样的数据
<ul><li>例如：可用来存储重定向路由</li></ul></li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 设置 --&gt;</span>
<span class="token comment">&lt;!-- 在 to 属性直接设置路径 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/?a=1&amp;b=2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 使用对象语法设置 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{name: 'user', params: {id: $route.params.id}, query: {locale: 'en'}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>User<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- query: 其值也是一个对象，在其中设置的键值对，就是查询参数 --&gt;</span>

<span class="token comment">&lt;!-- 访问 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{$route.query.locale}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="多路由视图-命名路由视图"><a href="#多路由视图-命名路由视图" aria-hidden="true" class="header-anchor">#</a> 多路由视图 / 命名路由视图</h2> <p>你不仅能对路由命名，也能对路由视图命名。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>header-top<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>	<span class="token comment">&lt;!-- 未命名的是默认：default --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>header-bottom<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// routes.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span> components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
		<span class="token keyword">default</span><span class="token punctuation">:</span> Home<span class="token punctuation">,</span>	<span class="token comment">// 前方引入</span>
		<span class="token string">'header-top'</span><span class="token punctuation">:</span> Header<span class="token punctuation">,</span>
		<span class="token string">'header-bottom'</span><span class="token punctuation">:</span> Header
	<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>满足根据不同路由改变页面布局的需求</li> <li>便于保存页面上某一部分的布局，便捷地置入不同路由页面中，动态渲染</li></ul> <h2 id="重定向"><a href="#重定向" aria-hidden="true" class="header-anchor">#</a> 重定向</h2> <p>当用户在地址栏输入的路径在路由中没有设置时，转移到想要抵达的页面。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// routes.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token comment">// 特定路径 to 特定路径</span>
	<span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/redirect-me'</span><span class="token punctuation">,</span> redirect<span class="token punctuation">:</span> <span class="token string">'/user'</span><span class="token punctuation">}</span>
	<span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/redirect-me'</span><span class="token punctuation">,</span> redirect<span class="token punctuation">:</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'user'</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
	<span class="token comment">// 不存在的路由 to 特定路由(如果和上面的都不匹配，就到达这个路由)</span>
	<span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'*'</span><span class="token punctuation">,</span> redirect<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">}</span>	<span class="token comment">// *: 匹配所有没有被匹配到的路由</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>Js 代码中跳转也可以作为重定向的补充。</p></blockquote> <h2 id="动画过渡"><a href="#动画过渡" aria-hidden="true" class="header-anchor">#</a> 动画过渡</h2> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>fade<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.fade-enter</span> <span class="token punctuation">{</span><span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">}</span>
<span class="token selector">.fade-enter-active</span> <span class="token punctuation">{</span><span class="token property">transition</span><span class="token punctuation">:</span> opacity 1s ease<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token selector">.fade-leave-active</span> <span class="token punctuation">{</span><span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token property">transition</span><span class="token punctuation">:</span> opacity 1s ease<span class="token punctuation">;</span><span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="传递-hash-fragment"><a href="#传递-hash-fragment" aria-hidden="true" class="header-anchor">#</a> 传递 Hash Fragment</h2> <ul><li>定位到页面特定位置：链接路径 + # + 元素锚点 id</li></ul> <blockquote><p>当链接为 link#demo 时，会跳转到 demo 节点，这是浏览器的默认行为。</p></blockquote> <p>当我们在应用不同页面间跳转，希望在进入页面时控制页面滚动的位置：</p> <ol><li>传入 hash 值</li></ol> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span>
	<span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{
			name: 'userEdit',
			params: {id: $route.params.id},
			query: {locale: 'en', q: 99},
			hash: '#data'
		}<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btn btn-primary<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>Edit User<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol start="2"><li>配置滚动行为</li></ol> <ul><li>定义 router 的 scrollBehavior 属性
<ul><li>参数：
<ul><li>to</li> <li>from</li> <li>savedPosition</li></ul></li> <li>返回：
<ul><li>包含 x, y 坐标的对象</li> <li>有 selector 属性的对象，值为标签元素 id 之类的选择器</li></ul></li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// main.js</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  routes<span class="token punctuation">,</span>
	mode<span class="token punctuation">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
	<span class="token comment">// 在此配置想要的滚动行为</span>
  <span class="token function">scrollBehavior</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> savedPosition</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>	<span class="token comment">// 如果点击了后退按钮或使用了滚动条滚动，浏览器会自动保存位置</span>
		<span class="token comment">// 检查 savedPosition 是否为空，因为如果点击后退按钮后退，用户不会想滚到一个新的位置。</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>savedPosition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> savedPostion<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 返回选择器对象</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>hash<span class="token punctuation">)</span> <span class="token punctuation">{</span>	<span class="token comment">// 判断有无 hash，hash 是否为空</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>selector<span class="token punctuation">:</span> to<span class="token punctuation">.</span>hash<span class="token punctuation">}</span><span class="token punctuation">;</span>	<span class="token comment">// 返回值就是滚动的位置</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// 返回坐标对象</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="保护路由"><a href="#保护路由" aria-hidden="true" class="header-anchor">#</a> 保护路由</h2> <ul><li>控制用户能否访问或离开某路由</li></ul> <h3 id="检测能否进入特定路由"><a href="#检测能否进入特定路由" aria-hidden="true" class="header-anchor">#</a> 检测能否进入特定路由</h3> <h4 id="main-js"><a href="#main-js" aria-hidden="true" class="header-anchor">#</a> main.js</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">{</span>
	<span class="token comment">// ...</span>
<span class="token punctuation">}</span>
router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">// ...</span>
	<span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用 Next 让路由操作继续执行</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><strong>beforeEach</strong>: 在每次路由跳转操作前执行
<ul><li>参数：一个函数
<ul><li>参数：
<ul><li>to 跳转后路由</li> <li>from 跳转前路由</li> <li>next
<ul><li>next() 让路由操作继续进行</li> <li>next(false) 终止路由，让用户停留在前一个页面</li> <li>next(path) 传入路径或 router-link 那样的对象，以实现重定向</li></ul></li></ul></li></ul></li> <li>可做笼统检测</li></ul></li></ul> <h4 id="保护特定路由"><a href="#保护特定路由" aria-hidden="true" class="header-anchor">#</a> 保护特定路由</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// routes.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">':id'</span><span class="token punctuation">,</span> component<span class="token punctuation">:</span> UserDetail<span class="token punctuation">,</span> <span class="token function-variable function">beforeEnter</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token comment">//...</span>
		<span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><strong>beforeEnter</strong>: 在每次此路由跳转操作前执行
<ul><li>用法与 beforeEach 同</li> <li>只在定义路由上生效</li></ul></li></ul> <h4 id="要加载的组件内控制"><a href="#要加载的组件内控制" aria-hidden="true" class="header-anchor">#</a> 要加载的组件内控制</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 要加载的组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			link<span class="token punctuation">:</span> <span class="token punctuation">{</span>path<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">beforeRouteEnter</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">//...</span>
		<span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 加载这个组件</span>
		<span class="token comment">// 访问此实例的回调</span>
		<span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>	<span class="token comment">// 把这个组件的实例 vm 传入一个函数，这个函数是在组价加载后执行的</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li><strong>beforeRouteEnter</strong>: 与生命钩子类似，不过由 vue-router 提供
<ul><li>参数：to/from/next
<ul><li>next
<ul><li>调用会加载这个组件</li> <li>不调用可以中断组件加载，<em>路由仍会跳转，但组件不会加载</em> <ul><li>组件不加载，不能在这个生命周期内访问 Vue 实例</li> <li>我们在这个对象中，但这个对象还没有完成初始化</li> <li>如果确实有访问实例的需求，可以给 next 传递一个回调</li></ul></li></ul></li></ul></li></ul></li></ul> <h3 id="检测能否离开特定路由"><a href="#检测能否离开特定路由" aria-hidden="true" class="header-anchor">#</a> 检测能否离开特定路由</h3> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btn btn-primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>confirmed = true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Confirm<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>
			confirmed<span class="token punctuation">:</span> <span class="token boolean">false</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function">beforeRouteLeave</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>confirmed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'Are you sure?'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ul><li><strong>beforeRouteLeave</strong>: 在用户离开这里跳转到其他路由之前执行
<ul><li>参数：</li> <li>唯一可以检测用户能否离开的地方</li></ul></li></ul> <h2 id="懒加载"><a href="#懒加载" aria-hidden="true" class="header-anchor">#</a> 懒加载</h2> <p>当打包构建应用时，JavaScript 包会变得非常大，影响页面加载。
如果我们能把不同路由对应的组件分割成不同的代码块，然后当路由被访问的时候才加载对应组件，这样就更加高效了。</p> <h3 id="结合-vue-异步组件-和-webpack-代码分割功能实现路由懒加载"><a href="#结合-vue-异步组件-和-webpack-代码分割功能实现路由懒加载" aria-hidden="true" class="header-anchor">#</a> 结合 Vue 异步组件 和 Webpack 代码分割功能实现路由懒加载</h3> <ol><li>将异步组件定义为返回一个 Promise 的工厂函数 (该函数返回的 Promise 应该 resolve 组件本身)：</li></ol> <ul><li><code>const Foo = () =&gt; Promise.resolve({ /* 组件定义对象 */ })</code></li></ul> <ol start="2"><li>在 Webpack 2 中，我们可以使用动态 import 语法来定义代码分块点 (split point)：</li></ol> <ul><li><code>import('./Foo.vue') // 返回 Promise</code></li></ul> <ol start="3"><li>结合这两者，这就是如何定义一个能够被 Webpack 自动代码分割的异步组件。</li></ol> <ul><li><code>const Foo = () =&gt; import('./Foo.vue')</code></li></ul> <ol start="4"><li>在路由配置中什么都不需要改变。</li></ol> <h3 id="把组件按组分块"><a href="#把组件按组分块" aria-hidden="true" class="header-anchor">#</a> 把组件按组分块</h3> <p>有时候我们想把某个路由下的所有组件都打包在同个异步块 (chunk) 中。只需要使用 命名 chunk ，一个特殊的注释语法来提供 chunk name (需要 Webpack &gt; 2.4)。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">Foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;group-foo&quot; */</span> <span class="token string">'./Foo.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">Bar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;group-foo&quot; */</span> <span class="token string">'./Bar.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">Baz</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;group-foo&quot; */</span> <span class="token string">'./Baz.vue'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Webpack 会将任何一个异步模块与相同的块名称组合到相同的异步块中。</p> <h3 id="老版语法"><a href="#老版语法" aria-hidden="true" class="header-anchor">#</a> 老版语法</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">User</span> <span class="token operator">=</span> <span class="token parameter">resolve</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./components/User.vue'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./components/User.vue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 第三个参数：分组名，多个组件打包为一个</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.aa07e3f0.js" defer></script><script src="/assets/js/2.3c3a8b86.js" defer></script><script src="/assets/js/20.7e1fbe74.js" defer></script>
  </body>
</html>
