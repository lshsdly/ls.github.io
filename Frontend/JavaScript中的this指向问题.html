<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript 中的 this 指向问题 | Better than never</title>
    <meta name="description" content="梁的个人网站">
    <link rel="icon" href="/logo.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.80698cd3.css" as="style"><link rel="preload" href="/assets/js/app.aa07e3f0.js" as="script"><link rel="preload" href="/assets/js/2.3c3a8b86.js" as="script"><link rel="preload" href="/assets/js/12.1232ddd6.js" as="script"><link rel="prefetch" href="/assets/js/10.16485189.js"><link rel="prefetch" href="/assets/js/11.087b2c37.js"><link rel="prefetch" href="/assets/js/13.d08737f4.js"><link rel="prefetch" href="/assets/js/14.5400c51f.js"><link rel="prefetch" href="/assets/js/15.6e20fcc4.js"><link rel="prefetch" href="/assets/js/16.8f188508.js"><link rel="prefetch" href="/assets/js/17.31b200b9.js"><link rel="prefetch" href="/assets/js/18.09631d42.js"><link rel="prefetch" href="/assets/js/19.ea1c561c.js"><link rel="prefetch" href="/assets/js/20.7e1fbe74.js"><link rel="prefetch" href="/assets/js/21.6a57e774.js"><link rel="prefetch" href="/assets/js/22.0b5e3d00.js"><link rel="prefetch" href="/assets/js/23.c0b1a40b.js"><link rel="prefetch" href="/assets/js/24.6aaf1c96.js"><link rel="prefetch" href="/assets/js/25.52f988b5.js"><link rel="prefetch" href="/assets/js/26.ca333bb8.js"><link rel="prefetch" href="/assets/js/27.c6dae7fd.js"><link rel="prefetch" href="/assets/js/28.5e816cc0.js"><link rel="prefetch" href="/assets/js/3.1a056928.js"><link rel="prefetch" href="/assets/js/4.1ae91333.js"><link rel="prefetch" href="/assets/js/5.9279dd66.js"><link rel="prefetch" href="/assets/js/6.5e5f6408.js"><link rel="prefetch" href="/assets/js/7.a81f715f.js"><link rel="prefetch" href="/assets/js/8.d07cfd7b.js"><link rel="prefetch" href="/assets/js/9.b0483dea.js">
    <link rel="stylesheet" href="/assets/css/0.styles.80698cd3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Better than never</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Frontend/" class="nav-link router-link-active">前端相关</a></div><div class="nav-item"><a href="/resume.html" class="nav-link">个人简历</a></div><div class="nav-item"><a href="/Tools.html" class="nav-link">工具资源（待）</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Frontend/" class="nav-link router-link-active">前端相关</a></div><div class="nav-item"><a href="/resume.html" class="nav-link">个人简历</a></div><div class="nav-item"><a href="/Tools.html" class="nav-link">工具资源（待）</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>JavaScript 中的 this 指向问题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Frontend/JavaScript%E4%B8%AD%E7%9A%84this%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98.html#两个误解" class="sidebar-link">两个误解</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Frontend/JavaScript%E4%B8%AD%E7%9A%84this%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98.html#四种指向" class="sidebar-link">四种指向</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Frontend/JavaScript%E4%B8%AD%E7%9A%84this%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98.html#_1-默认绑定" class="sidebar-link">1. 默认绑定</a></li><li class="sidebar-sub-header"><a href="/Frontend/JavaScript%E4%B8%AD%E7%9A%84this%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98.html#_2-隐式绑定" class="sidebar-link">2. 隐式绑定</a></li><li class="sidebar-sub-header"><a href="/Frontend/JavaScript%E4%B8%AD%E7%9A%84this%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98.html#_3-显式绑定" class="sidebar-link">3. 显式绑定</a></li><li class="sidebar-sub-header"><a href="/Frontend/JavaScript%E4%B8%AD%E7%9A%84this%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98.html#_4-new-绑定" class="sidebar-link">4. new 绑定</a></li><li class="sidebar-sub-header"><a href="/Frontend/JavaScript%E4%B8%AD%E7%9A%84this%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98.html#绑定优先级" class="sidebar-link">绑定优先级</a></li></ul></li><li><a href="/Frontend/JavaScript%E4%B8%AD%E7%9A%84this%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98.html#改变-this-指向" class="sidebar-link">改变 this 指向</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Frontend/JavaScript%E4%B8%AD%E7%9A%84this%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98.html#是不是所有函数都可以绑定-this？" class="sidebar-link">是不是所有函数都可以绑定 this？</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Frontend/JavaScript%E4%B8%AD%E7%9A%84this%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98.html#js-执行机制" class="sidebar-link">JS 执行机制</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript-中的-this-指向问题"><a href="#javascript-中的-this-指向问题" aria-hidden="true" class="header-anchor">#</a> JavaScript 中的 this 指向问题</h1> <h2 id="两个误解"><a href="#两个误解" aria-hidden="true" class="header-anchor">#</a> 两个误解</h2> <ol><li>this 指向自身</li> <li>this 指向函数作用域——在某种情况下是正确的</li></ol> <h2 id="四种指向"><a href="#四种指向" aria-hidden="true" class="header-anchor">#</a> 四种指向</h2> <h3 id="_1-默认绑定"><a href="#_1-默认绑定" aria-hidden="true" class="header-anchor">#</a> 1. 默认绑定</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'n1'</span>
<span class="token keyword">function</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'n2'</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// n1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>this 绑定在全局变量上，输出结果是 'n1'。</p> <h3 id="_2-隐式绑定"><a href="#_2-隐式绑定" aria-hidden="true" class="header-anchor">#</a> 2. 隐式绑定</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> member <span class="token operator">=</span> <span class="token string">'n1'</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>member<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> member <span class="token operator">=</span> <span class="token string">'zero'</span>
<span class="token keyword">var</span> demo <span class="token operator">=</span> <span class="token punctuation">{</span>
  member<span class="token punctuation">:</span> <span class="token string">'lufei'</span><span class="token punctuation">,</span>
  showMember<span class="token punctuation">:</span> show
<span class="token punctuation">}</span>

demo<span class="token punctuation">.</span><span class="token function">showMember</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// lufei</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>通过 demo 调用 show 函数，函数中的 this 被绑定到 demo 对象上，输出 'lufei'。</p> <h3 id="_3-显式绑定"><a href="#_3-显式绑定" aria-hidden="true" class="header-anchor">#</a> 3. 显式绑定</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> demo <span class="token operator">=</span> <span class="token punctuation">{</span>
  member<span class="token punctuation">:</span> <span class="token string">'lufei'</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> member <span class="token operator">=</span> <span class="token string">'zero'</span>
<span class="token keyword">function</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> member <span class="token operator">=</span> <span class="token string">'m1'</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>member<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">show</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>demo<span class="token punctuation">)</span> <span class="token comment">// lufei</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>通过 call/apply/bind 指定 this 的绑定对象。</p> <h3 id="_4-new-绑定"><a href="#_4-new-绑定" aria-hidden="true" class="header-anchor">#</a> 4. new 绑定</h3> <p>使用 new 调用函数，或构造函数调用。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">SeaPoacherBoat</span><span class="token punctuation">(</span><span class="token parameter">member</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>member <span class="token operator">=</span> member
<span class="token punctuation">}</span>
<span class="token keyword">var</span> demo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SeaPoacherBoat</span><span class="token punctuation">(</span><span class="token string">'lufei'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>demo<span class="token punctuation">.</span>member<span class="token punctuation">)</span> <span class="token comment">// lufei</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>执行操作：</p> <ol><li>创建一个全新对象</li> <li>进行原型（prototype）链接</li> <li>将新对象绑定到函数调用的 this</li> <li>如果没有返回其他对象，则自动返回一个新对象</li></ol> <h3 id="绑定优先级"><a href="#绑定优先级" aria-hidden="true" class="header-anchor">#</a> 绑定优先级</h3> <p>new &gt; 显式绑定 &gt; 隐式绑定 &gt; 默认</p> <blockquote><p>new 是生成了一个全新的对象，优先级最高，显式绑定要起作用，优先级必须高于隐式。</p></blockquote> <p><strong>this 是运行期间的绑定，与它声明的环境无关，只与它调用的对象有关。</strong></p> <h2 id="改变-this-指向"><a href="#改变-this-指向" aria-hidden="true" class="header-anchor">#</a> 改变 this 指向</h2> <ul><li>call</li> <li>apply</li> <li>bind</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'草帽海贼团'</span>
<span class="token keyword">var</span> hats <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'路飞'</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">printMember</span><span class="token punctuation">(</span><span class="token parameter">arg1<span class="token punctuation">,</span> arg2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'娜美'</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">printMember</span><span class="token punctuation">(</span><span class="token string">'山治'</span><span class="token punctuation">,</span> <span class="token string">'索隆'</span><span class="token punctuation">)</span> <span class="token comment">// 草帽海贼团 山治 索隆</span>
<span class="token function">printMember</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>caomao<span class="token punctuation">,</span> <span class="token string">'山治'</span><span class="token punctuation">,</span> <span class="token string">'索隆'</span><span class="token punctuation">)</span> <span class="token comment">// 路飞 山治 索隆</span>
<span class="token function">printMember</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>caomao<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'山治'</span><span class="token punctuation">,</span> <span class="token string">'索隆'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 路飞 山治 索隆</span>
<span class="token function">printMember</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>caomao<span class="token punctuation">,</span> <span class="token string">'山治'</span><span class="token punctuation">,</span> <span class="token string">'索隆'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 路飞 山治 索隆 </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>以call为基础来说，apply 是将后面的参数合成一个数组一起传人函数，bind最后返回的是一个函数，只有调用这个函数后才算执行。</p> <blockquote><p>有一种特殊情况就是把 null 和 undefined 作为this的绑定对象传入，这样实际是采用默认绑定原则。这有什么用途呢？见下：</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 用于展开数组</span>
<span class="token function">print</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 使用 bind 用于科里化——延迟执行最终结果</span>
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token function">print</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="是不是所有函数都可以绑定-this？"><a href="#是不是所有函数都可以绑定-this？" aria-hidden="true" class="header-anchor">#</a> 是不是所有函数都可以绑定 this？</h2> <p>ES6 新规则里，<strong>箭头函数</strong>不存在 this 绑定。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 全局调用</span>
<span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// window | {}</span>

<span class="token comment">// 对象中调用</span>
<span class="token keyword">function</span> <span class="token function">monkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  monkey<span class="token punctuation">:</span> monkey
<span class="token punctuation">}</span>
<span class="token keyword">var</span> other <span class="token operator">=</span> <span class="token punctuation">{</span>
  obj<span class="token punctuation">:</span> obj
<span class="token punctuation">}</span>

other<span class="token punctuation">.</span>obj<span class="token punctuation">.</span><span class="token function">monkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// { monkey: [Function: monkey] }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li>箭头中的 this 绑定在离最近外层的对象 obj 上, 而不是最终调用对象 other 上。</li></ul> <h2 id="js-执行机制"><a href="#js-执行机制" aria-hidden="true" class="header-anchor">#</a> JS 执行机制</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span>
<span class="token keyword">var</span> run
<span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token parameter">run</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> run <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>run <span class="token operator">=</span> run
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span>
run <span class="token operator">=</span> <span class="token number">3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>Output:
[Function: run]
window
2
2
3</p></blockquote> <blockquote><p>变量提升：</p> <ol><li>变量声明提升：函数声明被提到最上面，然后是变量</li> <li>声明后的变量不会重复声明——第二次声明不生效</li></ol></blockquote> <p>解析：</p> <ol><li>按顺序执行语句，遇到一个 run() 的调用，将 run 推入到执行栈中，进行以下步骤：</li> <li>绑定 this 和初始化参数，根据之前谈到的规则，this 绑定到调用它的全局对象 window，所以第二个 log 打印出 window 对象和传递过来的参数；</li> <li>同样在函数作用域中开始执行预解析，执行语句，函数中又定义了一个 run。作用域原理是就近查找，存在屏蔽作用，run 函数作用域中的 run 此刻为 2，所以第三个 log 会打印出 2；</li> <li>this.run = run 将全局中的 run 赋值为 2。</li> <li>执行完成后，run 函数出栈，继续执行全局语句，run 的值已经被改变成 2，所以此刻第四个 log 也打印出了 2，最终又被改变成 3，所以最后一个 log 打印为 3。</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.aa07e3f0.js" defer></script><script src="/assets/js/2.3c3a8b86.js" defer></script><script src="/assets/js/12.1232ddd6.js" defer></script>
  </body>
</html>
